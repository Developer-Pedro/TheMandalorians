# https://nerd.vision node agent

This is the official nerd.vision node agent. It is available in early access, so please give send us feedback on it's usability and if you find any issues! You can see the **known issues** at the bottom of this readme.

### Tech currently in use

 * Typescript 3.4
 * Node 10+

### Documentation
You can find the documentation at [docs.nerd.vision](https://docs.nerd.vision/node/install)

### Test apps

There are three test applications available for the node agent. Two are simple command line applications which generate a new uuid every second. The other is a very small todo web application. You can find the source code and install instructions for all of them here:

* [UUID generator](https://gitlab.com/steve_axtmann/node-test)
* [Todo web app](https://gitlab.com/nerd-vision/express-demo-application)
* [Typescript UUID generator](https://gitlab.com/nerd-vision/typescript-demo-application)

### Configuration Properties

All configuration properties are defined in [NerdVisionConfig](src/models/NerdVisionConfig.ts)

```typescript
interface NerdVisionConfig {
	apiKey: string;
	name?: string; // default: my-node-app
	debug?: boolean; // default: false
	tags?: { [key: string]: string }; // default: {}
}
```

### To use the published version in your own Node applications:

```bash
npm i @nerdvision/agent
```

Both `init` and `wrap` accept an API key, or the configuration object

```typescript
import {nerdvision, NerdVisionConfig} from '@nerdvision/agent';

const config: NerdVisionConfig = {
	// configuration
};

//
// THEN
//

nerdvision.init('API_KEY').then(() => {
	// application code
	
	// remember to run this when your application exits
	nerdvision.close();
});

//
// OR
//

nerdvision.wrap(config, async () => {
	// application code
	
	// this function must return a promise
	// when it resolves, the wrap function will disconnect automatically
});
```

You can also import with `require`:
```javascript
const {nerdvision} = require('@nerdvision/agent');

nerdvision.init('API_KEY'); // etc.
```

### Troubleshooting

> I get the error `TS7016: Could not find a declaration file for module 'google-protobuf'`
* You need to install types for google-protobuf: `npm i -D @types/google-protobuf`

### Known issues

* We currently use your package.json file as a reference for the root of the project. This means that the package.json must be in the root directory of your repo for now
* When using a pre-processor for JavaScript, like TypeScript, files that are lazy loaded may not trigger until they are run for a second time.
